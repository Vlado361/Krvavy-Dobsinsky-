<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Krvavý Dobšinský - Podcast</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Vlastné farby (Custom Colors) - Updated Color Palette */
        :root {
            /* New colors based on user request */
            --color-primary: #8a1c1c; /* Primary Red */
            --color-secondary: #e6d5b8; /* Beige */
            --color-card-bg: #f0e6d2; /* Light Beige */
            --color-dark-text: #333333; /* Dark Gray Text */
            --color-gray-text: #666666; /* Medium Gray Text */
            --color-light-text: #ffffff; /* White Text */

            /* Derived/Adjusted colors */
            --color-primary-hover: #a13d3d; /* Slightly lighter primary red for hover */
            --color-placeholder-bg: rgba(138, 28, 28, 0.5); /* Semi-transparent primary red for placeholders */
            --color-button-bg: rgba(51, 51, 51, 0.1); /* Light background for standard buttons (based on dark text) */
            --color-button-bg-hover: rgba(51, 51, 51, 0.2); /* Darker background for standard button hover */
            --color-input-border: rgba(51, 51, 51, 0.2); /* Subtle border for form inputs (based on dark text) */
            --color-input-bg: rgba(240, 230, 210, 0.3); /* Very light background for form inputs (based on card bg) */
            --color-focus-ring-primary: rgba(138, 28, 28, 0.4); /* Primary red focus ring */
            --color-focus-ring-white: rgba(255, 255, 255, 0.5); /* White focus ring for header buttons */
            --color-footer-bg: #333333; /* Footer background (using dark text color) */
            --color-accent: var(--color-primary); /* Use primary red as the main accent color (replaces gold) */
        }

        /* Apply custom colors using utility classes (optional but can be helpful) */
        .bg-primary { background-color: var(--color-primary); }
        .text-primary { color: var(--color-primary); }
        .border-primary { border-color: var(--color-primary); }
        .fill-primary { fill: var(--color-primary); }

        .bg-secondary { background-color: var(--color-secondary); }
        .text-secondary { color: var(--color-secondary); }

        .bg-card { background-color: var(--color-card-bg); }

        .text-dark { color: var(--color-dark-text); }
        .bg-dark { background-color: var(--color-dark-text); } /* Note: using dark text color as background */

        .text-gray { color: var(--color-gray-text); }
        .text-light { color: var(--color-light-text); }

        .bg-footer { background-color: var(--color-footer-bg); }

        /* Základné štýly tela a kontajnera (Basic body and container styles) */
        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* Ensure footer sticks to bottom */
            background-color: var(--color-secondary); /* Apply main background (Beige) */
            color: var(--color-dark-text); /* Apply default text color (Dark Gray) */
        }
        .container {
            flex-grow: 1; /* Allow main content to grow and push footer down */
        }

        /* Štýly pre textové elementy & Hover efekty (Styles for text elements & Hover effects) */
        .header-title {
            @apply text-3xl md:text-4xl font-bold relative z-10;
            transition: color 0.3s ease;
            cursor: default;
        }
        .header-subtitle {
            @apply text-base md:text-lg relative z-10 mt-2;
        }
        .nav-link {
            @apply text-sm cursor-pointer text-light transition-colors duration-200;
            transition-property: color, opacity; /* Add opacity to transition */
        }
        .nav-link:hover {
             color: var(--color-primary); /* Hover primary red */
             opacity: 0.8; /* Hover opacity */
        }

        .section-title {
            @apply text-2xl font-bold;
            transition: color 0.3s ease;
            cursor: pointer;
        }
        .section-title:hover {
            color: var(--color-primary); /* Hover primary red */
        }

        .episode-title { /* Title in main player */
            @apply text-xl font-bold text-primary; /* Primary red */
            transition: color 0.3s ease;
            cursor: pointer;
        }
        .episode-title:hover {
            color: var(--color-dark-text); /* Darker hover */
        }

        .episode-date { @apply text-xs text-gray; } /* Gray text */
        .episode-desc { @apply text-sm text-dark; } /* Dark text */
        .footer-text { @apply text-xs text-light; } /* Light text in footer */

        /* Specific styles for titles within cards */
        .card-episode-title, .card-text-title {
            @apply text-base font-bold text-primary; /* Primary red */
            transition: color 0.3s ease;
            cursor: pointer;
        }
        .card-episode-title:hover, .card-text-title:hover {
             color: var(--color-dark-text); /* Dark text on hover */
        }

        .card-episode-desc { @apply text-xs leading-normal text-dark; } /* Dark text */
        .card-text-excerpt { @apply text-sm leading-relaxed text-dark; } /* Dark text */
        .subscribe-text { @apply text-sm leading-relaxed text-dark; } /* Dark text */

        /* Indikátor sekcie (Section indicator) - Vertical primary red line */
        .section-indicator::before {
            content: '';
            display: block;
            width: 4px;
            height: 2.5rem; /* 40px */
            background-color: var(--color-primary); /* Use primary red */
            position: absolute;
            left: 0;
            top: 50%; /* Center vertically */
            transform: translateY(-50%); /* Adjust vertical centering */
        }
        .section-indicator {
            position: relative;
            padding-left: 1.25rem; /* 20px - space for the indicator */
            height: 40px; /* Match indicator height for alignment */
            display: flex;
            align-items: center;
        }


        /* Načítavanie (Loading placeholder & Spinner) */
        .loading-placeholder {
            background-color: var(--color-placeholder-bg); /* Use primary red transparent */
            border-radius: 0.375rem; /* 6px */
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 5rem; /* Give placeholder some minimum height */
        }

        /* Loading Spinner Styles */
        .loading-spinner {
            width: 2rem; /* 32px */
            height: 2rem; /* 32px */
            border: 4px solid rgba(255, 255, 255, 0.3); /* Light border */
            border-top-color: var(--color-primary); /* Primary red top border */
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }


        /* Audio prehrávač (Audio player) */
        audio {
            width: 100%;
            margin-top: 10px;
            height: 35px; /* Consistent height */
            filter: contrast(1.1) brightness(1.1); /* Subtle filter to match theme */
        }
        audio::-webkit-media-controls-panel {
          background-color: var(--color-card-bg); /* Match card background */
          border-radius: 6px;
        }
        audio::-webkit-media-controls-play-button,
        audio::-webkit-media-controls-mute-button {
          color: var(--color-primary); /* Use primary red for buttons */
          background-color: rgba(138, 28, 28, 0.1); /* Light primary red background */
          border-radius: 50%;
        }
        audio::-webkit-media-controls-play-button:hover,
        audio::-webkit-media-controls-mute-button:hover {
           background-color: rgba(138, 28, 28, 0.2); /* Darker on hover */
        }
        audio::-webkit-media-controls-timeline {
           background-color: var(--color-secondary); /* Beige background for timeline */
           border-radius: 4px;
           border: 1px solid rgba(51, 51, 51, 0.1);
        }
        audio::-webkit-media-controls-current-time-display,
        audio::-webkit-media-controls-time-remaining-display {
           color: var(--color-dark-text); /* Dark text for time */
           text-shadow: none;
        }
        audio::-webkit-media-controls-volume-slider {
           background-color: var(--color-secondary);
           border-radius: 4px;
           border: 1px solid rgba(51, 51, 51, 0.1);
        }


        /* Skrytie/zobrazenie placeholderov a content (Hide/show placeholders and content) */
        .loaded .loading-placeholder { display: none; }
        .loaded .content-placeholder { display: block; }
        .content-placeholder { display: none; }

        /* Placeholder text for empty grids - Now contains spinner */
        #all-episodes-grid:empty::before,
        #texts-grid:empty::before {
            content: 'Načítavam obsah...';
            position: absolute;
            width: 1px; height: 1px; padding: 0; margin: -1px;
            overflow: hidden; clip: rect(0, 0, 0, 0);
            white-space: nowrap; border-width: 0;
        }
         #all-episodes-grid:empty,
         #texts-grid:empty {
           display: flex; justify-content: center; align-items: center;
           min-height: 10rem; padding: 2rem;
         }
         #all-episodes-grid:empty::after,
         #texts-grid:empty::after {
             content: ''; display: block;
             width: 2.5rem; height: 2.5rem;
             border: 5px solid rgba(51, 51, 51, 0.2);
             border-top-color: var(--color-primary);
             border-radius: 50%;
             animation: spin 1s linear infinite;
         }


        /* View visibility */
        .view { display: none; } /* Hide all views by default */
        .view.active { display: block; } /* Show the active view */


        /* Štýl pre tlačidlá (Button styles) */
        .play-button, .read-more-button, .subscribe-button, .show-more-button {
            background-color: var(--color-button-bg);
            border-radius: 0.375rem; height: 35px;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 0.875rem; font-weight: 700; color: var(--color-dark-text);
            margin-top: 0.5rem; padding: 0 1.5rem; cursor: pointer; border: none;
            min-width: 150px; text-decoration: none;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: background-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
        }
        .play-button:hover, .read-more-button:hover, .subscribe-button:hover, .show-more-button:hover {
            background-color: var(--color-button-bg-hover);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: scale(1.05);
        }
        .play-button svg, .read-more-button svg, .subscribe-button svg, .show-more-button svg {
            width: 1em; height: 1em; margin-right: 0.5em; fill: currentColor;
        }

        /* Header specific button styles */
        .header-button {
             @apply inline-flex items-center justify-center bg-white bg-opacity-20 hover:bg-opacity-30 text-light font-semibold py-2 px-4 sm:px-5 rounded-lg shadow-md cursor-pointer;
             /* Added transform transition for click effect */
             transition: background-color 0.2s ease-in-out, opacity 0.2s ease-in-out, transform 0.1s ease-in-out;
        }
        /* Click effect for header buttons */
        .header-button:active {
            transform: scale(0.95); /* Slightly shrink the button on click */
        }


        /* Focus styles for accessibility */
         .play-button:focus, .read-more-button:focus, .subscribe-button:focus, .form-button:focus, .show-more-button:focus {
             outline: none;
             box-shadow: 0 0 0 3px var(--color-focus-ring-primary);
         }
         .header-button:focus {
            outline: none; /* Ensure default outline is removed */
            box-shadow: 0 0 0 3px var(--color-focus-ring-white); /* Keep white focus ring */
         }


        /* Štýly pre formulár (Form styles) */
        .form-label {
            display: block; margin-bottom: 0.5rem;
            font-size: 0.875rem; color: var(--color-dark-text); font-weight: 600;
        }
        .form-input, .form-textarea {
            width: 100%; padding: 0.75rem;
            border: 1px solid var(--color-input-border); border-radius: 0.375rem;
            background-color: var(--color-input-bg); color: var(--color-dark-text);
            margin-bottom: 1rem; font-size: 0.875rem;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.07);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none; border-color: var(--color-primary);
            box-shadow: 0 0 0 2px var(--color-focus-ring-primary), inset 0 1px 2px rgba(0,0,0,0.07);
        }
        .form-textarea {
            min-height: 150px; resize: vertical;
        }
        .form-button {
            background-color: var(--color-primary); color: var(--color-light-text);
            padding: 0.75rem 1.5rem; border: none; border-radius: 0.375rem;
            font-size: 0.875rem; font-weight: 700; cursor: pointer;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            transition: background-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
        }
        .form-button:hover {
            background-color: var(--color-primary-hover);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: scale(1.05);
        }
        .form-note {
            font-size: 0.75rem; color: var(--color-gray-text);
            margin-left: 0.5rem; font-weight: 400;
        }

        /* Štýly pre text v O podcaste (Styles for text in About section) */
        .about-text p {
             margin-bottom: 1rem; line-height: 1.625; color: var(--color-dark-text);
        }
        .about-text::after {
            content: ""; clear: both; display: table;
        }

        /* Card hover effect */
        .hoverable-card {
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }
        .hoverable-card:hover {
             transform: translateY(-3px);
             box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Twinkle animation for stars in header */
        @keyframes twinkle {
          0%, 100% { opacity: 0.2; }
          50% { opacity: 0.6; }
        }
        .animate-twinkle { animation: twinkle 4s linear infinite; }
        .animation-delay-700 { animation-delay: 0.7s; }
        .animation-delay-1400 { animation-delay: 1.4s; }

        /* Modal Styles */
        #simple-modal { background-color: rgba(0, 0, 0, 0.6); }
        #simple-modal > div { background-color: var(--color-card-bg); color: var(--color-dark-text); }
        #simple-modal h3 { color: var(--color-primary); }
        #simple-modal button {
            background-color: var(--color-primary); color: var(--color-light-text);
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
         #simple-modal button:hover {
             background-color: var(--color-primary-hover); transform: scale(1.03);
         }

    </style>
</head>
<body class="bg-secondary text-dark">

    <div class="container mx-auto max-w-6xl">

        <header class="relative overflow-hidden bg-gradient-to-b from-[--color-primary] to-[#5A0000] text-light text-center py-12 md:py-16 h-auto min-h-[300px] flex flex-col justify-center items-center shadow-lg px-4">
            <div class="absolute inset-0 z-0 pointer-events-none" aria-hidden="true">
                <svg class="absolute top-[15%] left-[10%] w-8 h-8 text-light opacity-30 transform -rotate-12" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                     <circle cx="8" cy="8" r="7.5"/>
                </svg>
                <svg class="absolute bottom-[10%] right-[12%] w-12 h-12 opacity-75 transform rotate-[25deg]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                     <circle cx="10" cy="10" r="7" fill="var(--color-primary)"/>
                     <ellipse cx="10" cy="10" rx="6" ry="3" fill="#FFBF00"/> <ellipse cx="10" cy="10" rx="1.5" ry="2.5" fill="var(--color-dark-text)"/>
                </svg>
                <svg class="absolute top-[20%] right-[15%] w-4 h-4 opacity-40 animate-twinkle" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                     <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                </svg>
                <svg class="absolute bottom-[25%] left-[20%] w-5 h-5 opacity-30 animate-twinkle animation-delay-700" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                     <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                </svg>
                 <svg class="absolute top-[55%] left-[5%] w-3 h-3 opacity-30 transform rotate-[-15deg]" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                     <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                 </svg>
                  <svg class="absolute top-[65%] right-[30%] w-4 h-4 opacity-40 transform rotate-6 animate-twinkle animation-delay-1400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                     <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                 </svg>
            </div>

            <h1 class="header-title">Krvavý Dobšinský</h1>
            <p class="header-subtitle">Mrazivé príbehy, ktoré vám nedajú spať.</p>
            <div class="mt-8 flex flex-wrap justify-center items-center gap-4 relative z-10">
                <a onclick="showView('subscribe')"
                    class="header-button"
                    aria-label="Prejsť na sekciu Odoberať">
                    Odoberať podcast
                </a>
                <a onclick="showView('contact')"
                    class="header-button"
                    aria-label="Prejsť na sekciu Kontakt">
                    Kontakt
                </a>
            </div>
        </header>

        <nav id="main-nav" class="bg-secondary bg-opacity-90 h-[50px] flex items-center justify-center space-x-3 sm:space-x-4 md:space-x-8 lg:space-x-12 sticky top-0 z-20 text-sm shadow-md">
             <a onclick="showView('home', '#latest')" class="nav-link">Najnovšia epizóda</a>
             <a onclick="showView('home', '#all')" class="nav-link">Všetky Epizódy</a>
             <a onclick="showView('about')" class="nav-link">O podcaste</a>
             <a onclick="showView('subscribe')" class="nav-link">Odoberať</a>
             <a onclick="showView('texts')" class="nav-link">Texty</a>
             <a onclick="showView('contact')" class="nav-link">Kontakt</a>
        </nav>

        <main class="px-4 md:px-8 lg:px-12 py-8">

            <div id="home-view" class="view active">
                <section id="latest" class="mb-12 scroll-mt-20">
                    <div class="section-indicator mb-5">
                         <h2 class="section-title">Prehrávač</h2>
                    </div>
                    <article id="latest-episode-card" class="bg-card rounded-lg p-4 md:p-6 flex flex-col md:flex-row items-center md:items-start space-y-4 md:space-y-0 md:space-x-6 min-h-[220px] shadow-lg overflow-hidden">
                        <div class="w-36 h-36 md:w-[180px] md:h-[180px] rounded-md flex-shrink-0 loading-placeholder">
                            <div class="loading-spinner"></div>
                        </div>
                        <img id="latest-episode-image" src="" alt="Obrázok prehrávanej epizódy" class="w-36 h-36 md:w-[180px] md:h-[180px] rounded-md flex-shrink-0 object-cover content-placeholder shadow-md" onerror="this.onerror=null; this.src='https://placehold.co/180x180/f0e6d2/333333?text=Obrázok\\nChýba'; this.alt='Náhradný obrázok epizódy';">
                        <div class="flex-grow">
                            <h3 id="latest-episode-title" class="episode-title">Načítavam názov...</h3>
                            <p id="latest-episode-date" class="episode-date mb-2">Načítavam dátum...</p>
                            <p id="latest-episode-description" class="episode-desc leading-relaxed mb-4">Načítavam popis...</p>
                            <div class="bg-black bg-opacity-10 rounded-md p-2 flex items-center justify-center space-x-3 h-[35px] loading-placeholder">
                                 <div class="loading-spinner w-5 h-5 border-2"></div>
                            </div>
                            <audio id="latest-episode-audio" controls class="content-placeholder" src="">Váš prehliadač nepodporuje audio element.</audio>
                        </div>
                    </article>
                    <p id="rss-error" class="text-primary mt-4" style="display: none;">Nepodarilo sa načítať RSS feed.</p>
                </section>

                <hr class="border-t border-primary border-opacity-60 my-8 w-3/4 mx-auto">

                <section id="all" class="mb-12 scroll-mt-20">
                     <div class="section-indicator mb-5">
                         <h2 class="section-title">Všetky Epizódy</h2>
                    </div>
                    <div id="all-episodes-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                    <div id="show-more-container" class="text-center mt-6" style="display: none;">
                         <button id="show-more-button" class="show-more-button w-full sm:w-auto">
                             Zobraziť viac
                         </button>
                    </div>
                    <p id="all-episodes-error" class="text-primary mt-4" style="display: none;">Nepodarilo sa načítať epizódy.</p>
                </section>

            </div>

            <div id="about-view" class="view">
                 <div class="section-indicator mb-5">
                     <h2 class="section-title">O podcaste</h2>
                 </div>
                 <div class="bg-card rounded-lg p-6 md:p-8 shadow-lg overflow-hidden">
                    <img src="https://i.imgur.com/F9fKCIr.png"
                         alt="Logo podcastu Krvavý Dobšinský"
                         class="w-32 h-32 md:w-40 md:h-40 rounded-md flex-shrink-0 object-cover mb-4 mr-6 md:mr-8 shadow-md float-left"
                         onerror="this.style.display='none'"> <div class="about-text text-left">
                        <p>Krvavý Dobšinský je originálny slovenský podcast plný strachu, symboliky a temnej krásy rozprávania. Už niekoľko rokov píšem a nahrávam vlastné strašidelné príbehy, ktoré čerpajú z folklóru, snov, tieňov aj z toho, čo si so sebou nesieme z detstva. Každá epizóda je napísaná autorsky – od prvého slova až po posledný dozvuk.</p>
                        <p>Tento podcast vznikol ako osobný projekt. Bez plánov, bez produkčného tímu, len s túžbou rozprávať. Dnes má viac ako milión vypočutí a tisíce verných fanúšikov, ktorí sa vracajú pre atmosféru, akú inde nenájdu.</p>
                        <p>Čo robí Krvavého Dobšinského výnimočným, je profesionálny zvukový dizajn, ktorý posúva príbehy ďaleko za hranice bežného rozprávania. Namiesto klasickej narácie vytváram akustický svet, kde počuť les, dych, vietor, dvere, ticho – a niekedy aj to, čo by tam byť nemalo.</p>
                        <p>Podcast nesie meno po Pavlovi Dobšinskom, ale jeho tón je iný: temnejší, existenciálnejší, intímnejší. Ak ťa lákajú strašidelné príbehy, slovenské legendy, záhadné zmiznutia a svet, kde sa prelína realita s podvedomím – vitaj.</p>
                        <p>Toto je podcast, ktorý nepočúvaš len ušami. Cítiš ho v tele.</p>
                    </div>
                 </div>
            </div>

            <div id="subscribe-view" class="view">
                 <div class="section-indicator mb-5">
                     <h2 class="section-title">Odoberať</h2>
                 </div>
                 <div class="bg-card rounded-lg p-6 md:p-8 shadow-lg">
                     <p class="subscribe-text mb-4">Nech ti žiadny príbeh neunikne.</p>
                     <p class="subscribe-text mb-4">Nové epizódy vychádzajú väčšinou každú stredu – no niekedy sa ozve aj niečo nečakané.</p>
                     <p class="subscribe-text mb-6">Pridaj si Krvavého Dobšinského medzi obľúbené a buď pri tom, keď sa opäť otvorí brána do tmy.</p>
                     <div class="flex flex-wrap gap-4">
                          <a href="https://open.spotify.com/show/YOUR_SPOTIFY_SHOW_ID" target="_blank" rel="noopener noreferrer" class="subscribe-button" aria-label="Odoberať na Spotify">
                              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-spotify" viewBox="0 0 16 16" aria-hidden="true">
                                   <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.669 11.538a.5.5 0 0 1-.686.165c-1.879-1.147-4.243-1.407-7.028-.77a.5.5 0 0 1-.222-.973c3.048-.696 5.662-.397 7.77.892a.5.5 0 0 1 .166.686m.979-2.17a.618.618 0 0 1-.858.205c-2.15-1.321-5.428-1.704-7.972-.932a.618.618 0 0 1-.28-.618c.034-.333.358-.595.681-.508 2.94.85 6.473 1.297 8.832-.078a.618.618 0 0 1 .205.858m.083-2.29a.74.74 0 0 1-1.026.271c-2.52-1.562-6.94-1.95-9.034-1.074a.739.739 0 0 1-.342-.74c.052-.43.484-.747.923-.695 2.512.94 7.473 1.412 10.088-.114a.74.74 0 0 1 .271 1.026"/>
                              </svg>
                              Spotify
                          </a>
                          <a href="https://podcasts.apple.com/sk/podcast/krvav%C3%BD-dob%C5%A1insk%C3%BD/id1608900257" target="_blank" rel="noopener noreferrer" class="subscribe-button" aria-label="Odoberať na Apple Podcasts">
                              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-apple" viewBox="0 0 16 16" aria-hidden="true">
                                   <path d="M11.182.008C10.148-.03 9.07 1.05 9.07 1.05s-1.068.983-1.068 2.657c0 1.675 1.021 2.578 1.021 2.578s.929 1.01 2.328 1.01c1.4 0 2.472-1.088 2.472-1.088s1.069-1.135 1.069-2.657c0-1.522-1.069-2.657-1.069-2.657s-1.02-1.116-2.198-1.116zm-2.112 6.025c.02-.018.04-.035.062-.053s.045-.036.068-.052c.18-.128.34-.26.478-.403.138-.142.25-.304.33-.488.08-.183.12-.386.12-.61s-.04-.427-.12-.61c-.08-.184-.192-.346-.33-.488-.138-.143-.299-.275-.478-.403-.023-.017-.046-.035-.068-.052s-.043-.035-.062-.053c-.06-.05-.116-.089-.168-.115-.052-.027-.103-.04-.15-.04H8.84c-.048 0-.099.013-.15.04-.052.026-.108.065-.168.115-.02.018-.04.035-.062.053s-.045.036-.068.052c-.18.128-.34.26-.478-.403-.138-.142-.25.304-.33.488-.08.183-.12.386-.12.61s.04.427.12.61c.08.184.192.346.33.488.138-.143.299.275.478.403.023.017.046.035.068.052s.043.035.062.053c.06.05.116.089.168.115.052.027.103.04.15.04h.298c.048 0 .099-.013.15-.04.052-.026.108-.065.168-.115z"/>
                                   <path d="M8.078 11.306c-.52-.026-1.026-.23-1.52-.638-.494-.408-.91-.94-1.26-1.6-.35-.66-.61-1.41-.79-2.24-.18-.83-.27-1.7-.27-2.58s.09-1.75.27-2.58c.18-.83.44-1.58.79-2.24.35-.66.766-1.192 1.26-1.6.494-.408 1-.612 1.52-.638.52-.026 1.03.096 1.512.362.482.266.89.644 1.217 1.134.327.49.565 1.07.712 1.735.147.665.22 1.38.22 2.145s-.073 1.48-.22 2.145c-.147.665-.385 1.245-.712 1.735-.327.49-.735.868-1.217 1.134-.482.266-.992.388-1.512.362z"/>
                              </svg>
                              Apple Podcasts
                          </a>
                          <a href="https://www.instagram.com/krvavydobsinsky/" target="_blank" rel="noopener noreferrer" class="subscribe-button" aria-label="Sledovať na Instagrame">
                              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16" aria-hidden="true">
                                   <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.703.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.297-.048c.852-.04 1.433-.174 1.942-.372.526-.205.972-.478 1.417-.923.445-.444.719-.89.923-1.417.198-.51.333-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.297c-.04-.852-.174-1.433-.372-1.942a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.09-.333-1.942-.372C10.445.01 10.173 0 8 0m0 1.442c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.282.24.705.275 1.485.039.843.047 1.096.047 3.233s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.92 2.5 2.5 0 0 1-.92.598c-.283.11-.705.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.598-.92c-.11-.282-.24-.705-.276-1.485C1.449 10.39 1.442 10.137 1.442 8s.007-2.39.046-3.233c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.843-.038 1.096-.047 3.232-.047M8 3.882a4.108 4.108 0 1 0 0 8.216 4.108 4.108 0 0 0 0-8.216m0 6.774a2.666 2.666 0 1 1 0-5.332 2.666 2.666 0 0 1 0 5.332m5.705-6.774a.96.96 0 1 0 0-1.92.96.96 0 0 0 0 1.92"/>
                              </svg>
                              Instagram
                          </a>
                     </div>
                 </div>
            </div>

            <div id="contact-view" class="view">
                 <div class="section-indicator mb-5">
                     <h2 class="section-title">Kontaktujte ma</h2>
                 </div>
                 <div class="bg-card rounded-lg p-6 md:p-8 shadow-lg">
                     <p class="text-dark mb-4 leading-relaxed">Máte príbeh, ktorý vám nedá spávať?</p>
                     <p class="text-dark mb-4 leading-relaxed">Možno ste ho zažili na vlastnej koži. Možno vám ho rozprávala stará mama. Možno sa stal… a možno nie.</p>
                     <p class="text-dark mb-6 leading-relaxed">Ak vo vás niečo zostalo – pocit, spomienka, príbeh – napíšte mi. Občas vyberiem niektorý z nich a spracujem ho do epizódy podcastu.</p>
                     <p class="text-dark mb-8 font-semibold">Nebojte sa – stačia slová. Atmosféru už doladím ja.</p>
                     <form id="contact-form" action="#" method="POST" onsubmit="handleContactFormSubmit(event)">
                         <div class="mb-4">
                             <label for="name" class="form-label">Vaše meno alebo prezývka <span class="form-note">(nepovinné)</span></label>
                             <input type="text" id="name" name="name" class="form-input" autocomplete="name">
                         </div>
                         <div class="mb-4">
                             <label for="email" class="form-label">E-mail <span class="form-note">(nepovinné, ak chcete, aby som sa ozval)</span></label>
                             <input type="email" id="email" name="email" class="form-input" autocomplete="email">
                         </div>
                         <div class="mb-4">
                             <label for="story-title" class="form-label">Názov príbehu <span class="form-note">(nepovinné)</span></label>
                             <input type="text" id="story-title" name="story-title" class="form-input">
                         </div>
                         <div class="mb-6">
                             <label for="story" class="form-label">Váš príbeh <span class="text-primary">*</span></label>
                             <textarea id="story" name="story" class="form-textarea" required aria-required="true"></textarea>
                         </div>
                         <div>
                             <button type="submit" class="form-button">Odoslať príbeh</button>
                         </div>
                     </form>
                     <p id="form-success-message" class="mt-4 text-green-700 font-semibold" style="display: none;">Ďakujem! Váš príbeh bol úspešne odoslaný (simulácia).</p>
                      <p id="form-error-message" class="mt-4 text-primary font-semibold" style="display: none;">Chyba: Vyplňte prosím pole "Váš príbeh".</p>
                 </div>
            </div>

            <div id="texts-view" class="view">
                 <div class="section-indicator mb-5">
                      <h2 class="section-title">Texty</h2>
                 </div>
                 <p class="text-dark mb-6 leading-relaxed">Tu nájdete prepisy vybraných epizód alebo iné bonusové texty k podcastu Krvavý Dobšinský.</p>
                 <div id="texts-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                      </div>
                 <p id="texts-error" class="text-primary mt-4" style="display: none;">Nepodarilo sa načítať texty.</p>
            </div>

        </main>

        <footer class="bg-footer text-light text-center py-6 mt-auto rounded-t-xl">
            <p class="footer-text mb-2">© 2025 Krvavý Dobšinský. Všetky práva vyhradené.</p>
            <div class="flex justify-center space-x-4">
                 <a href="https://open.spotify.com/show/YOUR_SPOTIFY_SHOW_ID" target="_blank" rel="noopener noreferrer" class="text-light hover:text-primary transition-colors" aria-label="Odoberať na Spotify">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-spotify w-5 h-5" viewBox="0 0 16 16" aria-hidden="true">
                          <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.669 11.538a.5.5 0 0 1-.686.165c-1.879-1.147-4.243-1.407-7.028-.77a.5.5 0 0 1-.222-.973c3.048-.696 5.662-.397 7.77.892a.5.5 0 0 1 .166.686m.979-2.17a.618.618 0 0 1-.858.205c-2.15-1.321-5.428-1.704-7.972-.932a.618.618 0 0 1-.28-.618c.034-.333.358-.595.681-.508 2.94.85 6.473 1.297 8.832-.078a.618.618 0 0 1 .205.858m.083-2.29a.74.74 0 0 1-1.026.271c-2.52-1.562-6.94-1.95-9.034-1.074a.739.739 0 0 1-.342-.74c.052-.43.484-.747.923-.695 2.512.94 7.473 1.412 10.088-.114a.74.74 0 0 1 .271 1.026"/>
                     </svg>
                 </a>
                 <a href="https://podcasts.apple.com/sk/podcast/krvav%C3%BD-dob%C5%A1insk%C3%BD/id1608900257" target="_blank" rel="noopener noreferrer" class="text-light hover:text-primary transition-colors" aria-label="Odoberať na Apple Podcasts">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-apple w-5 h-5" viewBox="0 0 16 16" aria-hidden="true">
                          <path d="M11.182.008C10.148-.03 9.07 1.05 9.07 1.05s-1.068.983-1.068 2.657c0 1.675 1.021 2.578 1.021 2.578s.929 1.01 2.328 1.01c1.4 0 2.472-1.088 2.472-1.088s1.069-1.135 1.069-2.657c0-1.522-1.069-2.657-1.069-2.657s-1.02-1.116-2.198-1.116zm-2.112 6.025c.02-.018.04-.035.062-.053s.045-.036.068-.052c.18-.128.34-.26.478-.403.138-.142.25-.304.33-.488.08-.183.12-.386.12-.61s-.04-.427-.12-.61c-.08-.184-.192-.346-.33-.488-.138-.143-.299-.275-.478-.403-.023-.017-.046-.035-.068-.052s-.043-.035-.062-.053c-.06-.05-.116-.089-.168-.115-.052-.027-.103-.04-.15-.04H8.84c-.048 0-.099.013-.15.04-.052.026-.108.065-.168.115-.02.018-.04.035-.062.053s-.045.036-.068.052c-.18.128-.34.26-.478-.403-.138-.142-.25.304-.33.488-.08.183-.12.386-.12.61s.04.427.12.61c.08.184.192.346.33.488.138-.143.299.275.478.403.023.017.046.035.068.052s.043.035.062.053c.06.05.116.089.168.115.052.027.103.04.15.04h.298c.048 0 .099-.013.15-.04.052-.026.108-.065.168-.115z"/>
                          <path d="M8.078 11.306c-.52-.026-1.026-.23-1.52-.638-.494-.408-.91-.94-1.26-1.6-.35-.66-.61-1.41-.79-2.24-.18-.83-.27-1.7-.27-2.58s.09-1.75.27-2.58c.18-.83.44-1.58.79-2.24.35-.66.766-1.192 1.26-1.6.494-.408 1-.612 1.52-.638.52-.026 1.03.096 1.512.362.482.266.89.644 1.217 1.134.327.49.565 1.07.712 1.735.147.665.22 1.38.22 2.145s-.073 1.48-.22 2.145c-.147.665-.385 1.245-.712 1.735-.327.49-.735.868-1.217 1.134-.482.266-.992.388-1.512.362z"/>
                     </svg>
                 </a>
                 <a href="https://www.instagram.com/krvavydobsinsky/" target="_blank" rel="noopener noreferrer" class="text-light hover:text-primary transition-colors" aria-label="Sledovať na Instagrame">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-instagram w-5 h-5" viewBox="0 0 16 16" aria-hidden="true">
                         <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.703.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.297-.048c.852-.04 1.433-.174 1.942-.372.526-.205.972-.478 1.417-.923.445-.444.719-.89.923-1.417.198-.51.333-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.297c-.04-.852-.174-1.433-.372-1.942a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.09-.333-1.942-.372C10.445.01 10.173 0 8 0m0 1.442c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.282.24.705.275 1.485.039.843.047 1.096.047 3.233s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.92 2.5 2.5 0 0 1-.92.598c-.283.11-.705.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.598-.92c-.11-.282-.24-.705-.276-1.485C1.449 10.39 1.442 10.137 1.442 8s.007-2.39.046-3.233c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.843-.038 1.096-.047 3.232-.047M8 3.882a4.108 4.108 0 1 0 0 8.216 4.108 4.108 0 0 0 0-8.216m0 6.774a2.666 2.666 0 1 1 0-5.332 2.666 2.666 0 0 1 0 5.332m5.705-6.774a.96.96 0 1 0 0-1.92.96.96 0 0 0 0 1.92"/>
                     </svg>
                 </a>
            </div>
        </footer>

    </div> <script>
        // --- Configuration ---
        const rssFeedUrl = 'https://anchor.fm/s/8db2e1ec/podcast/rss';
        const defaultImageUrl = 'https://i.imgur.com/F9fKCIr.png';
        const placeholderErrorImageUrl = 'https://placehold.co/180x180/f0e6d2/333333?text=Obrázok%0AChýba';
        const maxDescriptionLengthPlayer = 200;
        const maxDescriptionLengthGrid = 80;
        const maxExcerptLengthTexts = 120;
        const initialEpisodesToShowDesktop = 6;
        const initialEpisodesToShowMobile = 3;
        const episodeBatchSizeDesktop = 6;
        const episodeBatchSizeMobile = 3;

        // --- Global variables ---
        let allPodcastItems = [];
        let currentlyDisplayedCount = 0;

        // --- DOM Element References ---
        const playerSection = document.getElementById('latest');
        const playerCard = document.getElementById('latest-episode-card');
        const playerImage = document.getElementById('latest-episode-image');
        const playerTitle = document.getElementById('latest-episode-title');
        const playerDate = document.getElementById('latest-episode-date');
        const playerDescription = document.getElementById('latest-episode-description');
        const playerAudio = document.getElementById('latest-episode-audio');
        const rssError = document.getElementById('rss-error');
        const allEpisodesGrid = document.getElementById('all-episodes-grid');
        const allEpisodesError = document.getElementById('all-episodes-error');
        const showMoreContainer = document.getElementById('show-more-container');
        const showMoreButton = document.getElementById('show-more-button');
        const textsGrid = document.getElementById('texts-grid');
        const textsError = document.getElementById('texts-error');
        const homeView = document.getElementById('home-view');
        const contactView = document.getElementById('contact-view');
        const aboutView = document.getElementById('about-view');
        const textsView = document.getElementById('texts-view');
        const subscribeView = document.getElementById('subscribe-view');
        const views = document.querySelectorAll('.view');
        const contactForm = document.getElementById('contact-form');
        const formSuccessMessage = document.getElementById('form-success-message');
        const formErrorMessage = document.getElementById('form-error-message');

        // --- View Management ---
        function showView(viewId, scrollToSelector = null) {
            console.log(`Switching to view: ${viewId}, scroll target: ${scrollToSelector || 'none'}`);
            views.forEach(view => view.classList.remove('active'));
            const activeView = document.getElementById(`${viewId}-view`);
            if (activeView) {
                activeView.classList.add('active');
                if (scrollToSelector) {
                    const elementToScroll = activeView.querySelector(scrollToSelector);
                    if (elementToScroll) {
                        setTimeout(() => elementToScroll.scrollIntoView({ behavior: 'smooth', block: 'start' }), 0);
                    } else {
                        console.warn(`Scroll target '${scrollToSelector}' not found in view '${viewId}'. Scrolling to top.`);
                        setTimeout(() => window.scrollTo({ top: 0, behavior: 'smooth' }), 0);
                    }
                } else {
                    setTimeout(() => window.scrollTo({ top: 0, behavior: 'smooth' }), 0);
                }
            } else {
                console.error(`View '${viewId}-view' not found. Defaulting to home.`);
                homeView.classList.add('active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // --- Utility Functions ---
        function formatSlovakDate(dateString) {
            if (!dateString) return '';
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) throw new Error("Invalid date string");
                return date.toLocaleDateString('sk-SK', { year: 'numeric', month: 'long', day: 'numeric' });
            } catch (e) {
                console.error("Date formatting error:", dateString, e);
                return dateString;
            }
        }

        function extractAndShortenText(htmlString, maxLength = 100) {
            if (!htmlString) return "";
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlString;
            let text = (tempDiv.textContent || tempDiv.innerText || "").trim();
            text = text.replace(/https?:\/\/[^\s]+$/, '').trim();
            if (text.length > maxLength) {
                let lastSpace = text.lastIndexOf(' ', maxLength - 3);
                if (lastSpace === -1 || lastSpace < maxLength / 2) lastSpace = maxLength - 3;
                return text.substring(0, lastSpace).trim() + '...';
            }
            return text;
        }

        // --- Episode Card Creation ---
        function createEpisodeCard(item) {
            const title = item.querySelector("title")?.textContent || "Neznáma epizóda";
            const pubDate = item.querySelector("pubDate")?.textContent || "";
            const descriptionHtml = item.querySelector("content\\:encoded")?.textContent || item.querySelector("description")?.textContent || "";
            const audioUrl = item.querySelector("enclosure")?.getAttribute("url") || "";
            const imageUrl = item.querySelector("itunes\\:image")?.getAttribute("href")
                            || item.closest('channel')?.querySelector("itunes\\:image")?.getAttribute("href")
                            || defaultImageUrl;
            const card = document.createElement('article');
            card.dataset.fullDesc = descriptionHtml;
            card.className = 'bg-card rounded-lg p-4 sm:p-5 flex flex-col min-h-[220px] shadow-lg hoverable-card';
            card.innerHTML = `
                <h3 class="card-episode-title mb-1">${title}</h3>
                <p class="episode-date mb-2">${formatSlovakDate(pubDate)}</p>
                <p class="card-episode-desc leading-normal mb-3 flex-grow overflow-hidden">
                    ${extractAndShortenText(descriptionHtml, maxDescriptionLengthGrid)}
                </p>
                <button class="play-button mt-auto"
                        data-audio-src="${audioUrl}"
                        data-title="${title.replace(/"/g, '"')}"
                        data-img-src="${imageUrl}"
                        aria-label="Prehrať epizódu ${title.replace(/"/g, '"')}">
                    <svg viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M8 5v14l11-7z"></path></svg>
                    Prehrať
                </button>`;
            return card;
        }


        // --- Event Handlers ---
        function handlePlayButtonClick(event) {
            const button = event.target.closest('.play-button');
            if (!button) return;
            const audioSrc = button.dataset.audioSrc;
            const title = button.dataset.title;
            const imgSrc = button.dataset.imgSrc || defaultImageUrl;
            if (!audioSrc) {
                console.error("Audio source missing.");
                showModal("Chyba prehrávania", "Pre túto epizódu sa nenašiel zvukový súbor.");
                return;
            }
            console.log(`Play clicked: ${title}`);
            const parentArticle = button.closest('article');
            const fullDescriptionHtml = parentArticle?.dataset.fullDesc || '';
            const dateText = parentArticle?.querySelector('.episode-date')?.textContent || '';
            playerTitle.textContent = title || "Neznáma epizóda";
            playerDate.textContent = dateText;
            playerDescription.textContent = extractAndShortenText(fullDescriptionHtml, maxDescriptionLengthPlayer) || "Popis nie je k dispozícii.";
            playerImage.src = imgSrc;
            playerImage.onerror = () => { playerImage.src = placeholderErrorImageUrl; playerImage.onerror = null; };
            if (playerAudio.src !== audioSrc) {
                playerAudio.src = audioSrc;
                playerAudio.load();
                playerAudio.play().catch(e => { console.error("Audio playback error:", e); showModal("Chyba prehrávania", `Nepodarilo sa spustiť prehrávanie: ${e.message}`); });
            } else if (playerAudio.paused) {
                playerAudio.play().catch(e => { console.error("Audio playback error:", e); showModal("Chyba prehrávania", `Nepodarilo sa spustiť prehrávanie: ${e.message}`); });
            }
            playerCard.classList.add('loaded');
            playerSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function handleContactFormSubmit(event) {
            event.preventDefault();
            formSuccessMessage.style.display = 'none';
            formErrorMessage.style.display = 'none';
            const storyTextarea = document.getElementById('story');
            const storyText = storyTextarea.value.trim();
            if (!storyText) {
                formErrorMessage.textContent = 'Chyba: Pole "Váš príbeh" je povinné.';
                formErrorMessage.style.display = 'block';
                storyTextarea.focus();
                return;
            }
            console.log("Form submitted (simulation):", Object.fromEntries(new FormData(contactForm)));
            formSuccessMessage.style.display = 'block';
            contactForm.reset();
            setTimeout(() => { formSuccessMessage.style.display = 'none'; }, 5000);
        }

        function handleShowMoreClick() {
            const isMobile = window.innerWidth < 640;
            const currentBatchSize = isMobile ? episodeBatchSizeMobile : episodeBatchSizeDesktop;
            console.log(`Showing next batch of ${currentBatchSize} episodes...`);
            const currentGridCount = allEpisodesGrid.children.length;
            const startIndex = currentGridCount;
            const endIndex = startIndex + currentBatchSize;
            const itemsToAppend = allPodcastItems.slice(startIndex, endIndex);
            itemsToAppend.forEach(item => {
                try { allEpisodesGrid.appendChild(createEpisodeCard(item)); }
                catch(e) { console.error("Error creating additional card:", e); }
            });
            currentlyDisplayedCount = allEpisodesGrid.children.length;
            console.log(`Now displaying ${currentlyDisplayedCount} episodes.`);
            if (currentlyDisplayedCount >= allPodcastItems.length) {
                showMoreContainer.style.display = 'none';
                console.log("All episodes displayed.");
            }
        }

        // --- Data Loading ---
        function loadRssData() {
            console.log("Loading RSS:", rssFeedUrl);
            fetch(rssFeedUrl)
                .then(response => {
                    if (!response.ok) throw new Error(`Network error: ${response.statusText} (${response.status})`);
                    return response.text();
                })
                .then(str => {
                    const parser = new window.DOMParser();
                    const data = parser.parseFromString(str, "text/xml");
                    const parseError = data.querySelector("parsererror");
                    if (parseError) throw new Error(`XML Parse Error: ${parseError.textContent}`);
                    console.log("RSS Parsed.");
                    return data;
                })
                .then(data => {
                    allPodcastItems = Array.from(data.querySelectorAll("item"));
                    if (allPodcastItems.length === 0) throw new Error("No episode items found.");

                    // Populate Player
                    const firstItem = allPodcastItems[0];
                    try {
                        const title = firstItem.querySelector("title")?.textContent || "Neznámy názov";
                        const pubDate = firstItem.querySelector("pubDate")?.textContent || "";
                        const descriptionHtml = firstItem.querySelector("content\\:encoded")?.textContent || firstItem.querySelector("description")?.textContent || "";
                        const audioUrl = firstItem.querySelector("enclosure")?.getAttribute("url") || "";
                        const imageUrl = firstItem.querySelector("itunes\\:image")?.getAttribute("href") || data.querySelector("channel > itunes\\:image")?.getAttribute("href") || defaultImageUrl;
                        playerTitle.textContent = title;
                        playerDate.textContent = formatSlovakDate(pubDate);
                        playerDescription.textContent = extractAndShortenText(descriptionHtml, maxDescriptionLengthPlayer);
                        playerImage.src = imageUrl;
                        playerImage.onerror = () => { playerImage.src = placeholderErrorImageUrl; playerImage.onerror = null; };
                        playerAudio.src = audioUrl;
                        playerCard.classList.add('loaded');
                        rssError.style.display = 'none';
                    } catch (e) {
                        console.error("Error processing latest episode:", e);
                        rssError.textContent = 'Chyba pri spracovaní najnovšej epizódy.';
                        rssError.style.display = 'block';
                        playerCard.classList.add('loaded');
                        playerTitle.textContent = 'Chyba'; playerDate.textContent = '-'; playerDescription.textContent = 'Nepodarilo sa načítať.'; playerImage.src = placeholderErrorImageUrl; playerImage.style.display = 'block'; playerAudio.style.display = 'none';
                    }

                    // Populate Initial Grid
                    allEpisodesGrid.innerHTML = '';
                    const isMobile = window.innerWidth < 640;
                    const numEpisodesToDisplay = isMobile ? initialEpisodesToShowMobile : initialEpisodesToShowDesktop;
                    const initialItems = allPodcastItems.slice(0, numEpisodesToDisplay);
                    initialItems.forEach(item => {
                         try { allEpisodesGrid.appendChild(createEpisodeCard(item)); }
                         catch(e) { console.error("Error creating initial card:", e); }
                    });
                    currentlyDisplayedCount = allEpisodesGrid.children.length;
                    console.log(`Initially displaying ${currentlyDisplayedCount} episodes.`);

                    // Setup Show More Button
                    if (allPodcastItems.length > currentlyDisplayedCount) {
                        showMoreContainer.style.display = 'block';
                    } else {
                        showMoreContainer.style.display = 'none';
                    }
                    if (allEpisodesGrid.children.length === 0 && allPodcastItems.length > 0) {
                         allEpisodesError.textContent = 'Nepodarilo sa zobraziť epizódy (chyba pri vytváraní kariet).';
                         allEpisodesError.style.display = 'block';
                         showMoreContainer.style.display = 'none';
                    } else {
                         allEpisodesError.style.display = 'none';
                    }
                })
                .catch(error => {
                    console.error("Failed to load/process RSS feed:", error);
                    rssError.textContent = `Chyba načítania podcastu: ${error.message}. Skúste obnoviť stránku.`;
                    rssError.style.display = 'block';
                    allEpisodesError.textContent = `Chyba načítania epizód: ${error.message}.`;
                    allEpisodesError.style.display = 'block';
                    playerCard.classList.add('loaded');
                    playerTitle.textContent = 'Chyba'; playerDate.textContent = '-'; playerDescription.textContent = 'Nepodarilo sa načítať dáta.'; playerImage.src = placeholderErrorImageUrl; playerImage.style.display = 'block'; playerAudio.style.display = 'none';
                    allEpisodesGrid.innerHTML = `<p class="col-span-full text-center text-primary p-4">${allEpisodesError.textContent}</p>`;
                    showMoreContainer.style.display = 'none';
                });
        }

        function loadTextsData() {
            console.log("Loading texts data (placeholders)...");
            textsGrid.innerHTML = '';
            const placeholderTexts = [
                { title: "Prepis: Zmiznutie v lese", excerpt: "Hlboko v hore sa stratil mladý muž. Nikdy ho nenašli, no miestni hovoria o šepotoch medzi stromami a svetlách, ktoré tam nemajú čo robiť...", link: "#" },
                { title: "Bonus: Pôvod legendy o poludnici", excerpt: "Poludnica, bytosť trestajúca tých, čo nedodržiavajú poludňajší pokoj. Aké sú korene tejto strašidelnej postavy slovanského folklóru?", link: "#" },
                { title: "Prepis: Dom na konci ulice", excerpt: "Opustený dom, ktorý láka deti svojimi tajomstvami. Ale čo ak dom nechce, aby odišli? Príbeh inšpirovaný skutočnými udalosťami.", link: "#" }
            ];
            if (placeholderTexts.length === 0) {
                textsGrid.innerHTML = `<p class="col-span-full text-center text-dark p-4">Momentálne nie sú k dispozícii žiadne texty.</p>`;
                textsError.style.display = 'none';
                return;
            }
            placeholderTexts.forEach(text => {
                try {
                    const card = document.createElement('article');
                    card.className = 'bg-card rounded-lg p-4 sm:p-5 flex flex-col min-h-[220px] shadow-lg hoverable-card';
                    card.innerHTML = `
                         <h3 class="card-text-title mb-2">${text.title}</h3>
                         <p class="card-text-excerpt leading-normal mb-3 flex-grow overflow-hidden">
                             ${extractAndShortenText(text.excerpt, maxExcerptLengthTexts)}
                         </p>
                         <button class="read-more-button mt-auto"
                                 onclick="showModal('Text ešte nie je dostupný', 'Obsah pre \\"${text.title.replace(/"/g, '"')}\\" bude čoskoro pridaný.')"
                                 aria-label="Čítať viac o ${text.title.replace(/"/g, '"')}">
                             <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-book-half" viewBox="0 0 16 16" aria-hidden="true">
                                 <path d="M8.5 2.687c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388 1.17.953.712 1.04 1.73.108 2.686-.744.75-1.898 1.134-3.174 1.233C11.253 7.128 10 6.6 8.5 5.66z"/>
                                 <path d="M16 14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V1.5A.5.5 0 0 1 4.5 1H6v10.5A1.5 1.5 0 0 0 7.5 13h7a.5.5 0 0 1 .5.5"/>
                             </svg>
                             Čítať viac
                         </button>`;
                    textsGrid.appendChild(card);
                } catch (e) { console.error("Error creating text card:", e); }
            });
            textsError.style.display = 'none';
            console.log(`Populated texts grid with ${textsGrid.children.length} placeholders.`);
        }

        function showModal(title, message) {
            const existingModal = document.getElementById('simple-modal');
            if (existingModal) existingModal.remove();
            const modalOverlay = document.createElement('div');
            modalOverlay.id = 'simple-modal';
            modalOverlay.className = 'fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4';
            modalOverlay.setAttribute('role', 'dialog');
            modalOverlay.setAttribute('aria-modal', 'true');
            modalOverlay.setAttribute('aria-labelledby', 'modal-title');
            modalOverlay.setAttribute('aria-describedby', 'modal-message');
            const modalContent = document.createElement('div');
            modalContent.className = 'bg-card text-dark p-6 rounded-lg shadow-xl max-w-sm w-full';
            const modalTitle = document.createElement('h3');
            modalTitle.id = 'modal-title';
            modalTitle.className = 'text-xl font-bold text-primary mb-3';
            modalTitle.textContent = title;
            const modalMessage = document.createElement('p');
            modalMessage.id = 'modal-message';
            modalMessage.className = 'text-sm mb-4';
            modalMessage.textContent = message;
            const closeButton = document.createElement('button');
            closeButton.className = 'form-button mt-4 w-full';
            closeButton.textContent = 'Zavrieť';
            closeButton.onclick = () => modalOverlay.remove();
            modalContent.appendChild(modalTitle);
            modalContent.appendChild(modalMessage);
            modalContent.appendChild(closeButton);
            modalOverlay.appendChild(modalContent);
            document.body.appendChild(modalOverlay);
            closeButton.focus();
            modalOverlay.addEventListener('click', (event) => { if (event.target === modalOverlay) modalOverlay.remove(); });
            function handleEscape(event) {
                if (event.key === 'Escape') {
                    modalOverlay.remove();
                    document.removeEventListener('keydown', handleEscape);
                }
            }
            document.addEventListener('keydown', handleEscape);
        }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM fully loaded and parsed. Initializing page functions.");
            allEpisodesGrid.addEventListener('click', handlePlayButtonClick);
            if (showMoreButton) showMoreButton.addEventListener('click', handleShowMoreClick);
            if (contactForm) contactForm.addEventListener('submit', handleContactFormSubmit);
            loadRssData();
            loadTextsData();
        });

    </script>

</body>
</html>
